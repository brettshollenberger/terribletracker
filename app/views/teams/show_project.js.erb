// Render the project's show page in the main body
$('#body-main').html('').append('<%= j render("/projects/show_project") %>');

// If another project was previously checked, uncheck it
<% if @checked_project %>
  <% unless @checked_project.nil? %>
    $('.project_checked').each(function() {
      $(this).remove();
    });
    $('label').each(function() {
      var for_label = $(this).attr('for');
      if ( for_label == "project_<%= @checked_project %>" ) { $(this).removeClass('checked'); }
    });
    $('input[name=project_<%= @checked_project %>]').attr('checked', false);
  <% end %>
<% end %>

// Add the project_checked hidden_field to all project_sidebar forms
$('.project_sidebar').each(function() {
  $(this).append('<%= j hidden_field_tag :checked, "#{@project.id}", :class => "project_checked" %>');
});
